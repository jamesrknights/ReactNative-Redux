2b2e60077ef08e8e2f389514b585c84c

'use strict';

var Dimensions = require('Dimensions');
var FrameRateLogger = require('FrameRateLogger');
var Keyboard = require('Keyboard');
var ReactNative = require('ReactNative');
var Subscribable = require('Subscribable');
var TextInputState = require('TextInputState');
var UIManager = require('UIManager');

var invariant = require('fbjs/lib/invariant');
var nullthrows = require('fbjs/lib/nullthrows');
var performanceNow = require('fbjs/lib/performanceNow');
var warning = require('fbjs/lib/warning');

var _require = require('NativeModules'),
    ScrollViewManager = _require.ScrollViewManager;

var _require2 = require('ReactNativeComponentTree'),
    getInstanceFromNode = _require2.getInstanceFromNode;

var IS_ANIMATING_TOUCH_START_THRESHOLD_MS = 16;

function isTagInstanceOfTextInput(tag) {
  var instance = getInstanceFromNode(tag);
  return instance && instance.viewConfig && (instance.viewConfig.uiViewClassName === 'AndroidTextInput' || instance.viewConfig.uiViewClassName === 'RCTMultilineTextInputView' || instance.viewConfig.uiViewClassName === 'RCTSinglelineTextInputView');
}

var ScrollResponderMixin = {
  mixins: [Subscribable.Mixin],
  scrollResponderMixinGetInitialState: function scrollResponderMixinGetInitialState() {
    return {
      isTouching: false,
      lastMomentumScrollBeginTime: 0,
      lastMomentumScrollEndTime: 0,

      observedScrollSinceBecomingResponder: false,
      becameResponderWhileAnimating: false
    };
  },

  scrollResponderHandleScrollShouldSetResponder: function scrollResponderHandleScrollShouldSetResponder() {
    return this.state.isTouching;
  },

  scrollResponderHandleStartShouldSetResponder: function scrollResponderHandleStartShouldSetResponder(e) {
    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();

    if (this.props.keyboardShouldPersistTaps === 'handled' && currentlyFocusedTextInput != null && e.target !== currentlyFocusedTextInput) {
      return true;
    }
    return false;
  },

  scrollResponderHandleStartShouldSetResponderCapture: function scrollResponderHandleStartShouldSetResponderCapture(e) {
    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();
    var keyboardShouldPersistTaps = this.props.keyboardShouldPersistTaps;

    var keyboardNeverPersistTaps = !keyboardShouldPersistTaps || keyboardShouldPersistTaps === 'never';
    if (keyboardNeverPersistTaps && currentlyFocusedTextInput != null && !isTagInstanceOfTextInput(e.target)) {
      return true;
    }
    return this.scrollResponderIsAnimating();
  },

  scrollResponderHandleResponderReject: function scrollResponderHandleResponderReject() {},

  scrollResponderHandleTerminationRequest: function scrollResponderHandleTerminationRequest() {
    return !this.state.observedScrollSinceBecomingResponder;
  },

  scrollResponderHandleTouchEnd: function scrollResponderHandleTouchEnd(e) {
    var nativeEvent = e.nativeEvent;
    this.state.isTouching = nativeEvent.touches.length !== 0;
    this.props.onTouchEnd && this.props.onTouchEnd(e);
  },

  scrollResponderHandleTouchCancel: function scrollResponderHandleTouchCancel(e) {
    this.state.isTouching = false;
    this.props.onTouchCancel && this.props.onTouchCancel(e);
  },

  scrollResponderHandleResponderRelease: function scrollResponderHandleResponderRelease(e) {
    this.props.onResponderRelease && this.props.onResponderRelease(e);

    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();
    if (this.props.keyboardShouldPersistTaps !== true && this.props.keyboardShouldPersistTaps !== 'always' && currentlyFocusedTextInput != null && e.target !== currentlyFocusedTextInput && !this.state.observedScrollSinceBecomingResponder && !this.state.becameResponderWhileAnimating) {
      this.props.onScrollResponderKeyboardDismissed && this.props.onScrollResponderKeyboardDismissed(e);
      TextInputState.blurTextInput(currentlyFocusedTextInput);
    }
  },

  scrollResponderHandleScroll: function scrollResponderHandleScroll(e) {
    this.state.observedScrollSinceBecomingResponder = true;
    this.props.onScroll && this.props.onScroll(e);
  },

  scrollResponderHandleResponderGrant: function scrollResponderHandleResponderGrant(e) {
    this.state.observedScrollSinceBecomingResponder = false;
    this.props.onResponderGrant && this.props.onResponderGrant(e);
    this.state.becameResponderWhileAnimating = this.scrollResponderIsAnimating();
  },

  scrollResponderHandleScrollBeginDrag: function scrollResponderHandleScrollBeginDrag(e) {
    FrameRateLogger.beginScroll();
    this.props.onScrollBeginDrag && this.props.onScrollBeginDrag(e);
  },

  scrollResponderHandleScrollEndDrag: function scrollResponderHandleScrollEndDrag(e) {
    var velocity = e.nativeEvent.velocity;

    if (!this.scrollResponderIsAnimating() && (!velocity || velocity.x === 0 && velocity.y === 0)) {
      FrameRateLogger.endScroll();
    }
    this.props.onScrollEndDrag && this.props.onScrollEndDrag(e);
  },

  scrollResponderHandleMomentumScrollBegin: function scrollResponderHandleMomentumScrollBegin(e) {
    this.state.lastMomentumScrollBeginTime = performanceNow();
    this.props.onMomentumScrollBegin && this.props.onMomentumScrollBegin(e);
  },

  scrollResponderHandleMomentumScrollEnd: function scrollResponderHandleMomentumScrollEnd(e) {
    FrameRateLogger.endScroll();
    this.state.lastMomentumScrollEndTime = performanceNow();
    this.props.onMomentumScrollEnd && this.props.onMomentumScrollEnd(e);
  },

  scrollResponderHandleTouchStart: function scrollResponderHandleTouchStart(e) {
    this.state.isTouching = true;
    this.props.onTouchStart && this.props.onTouchStart(e);
  },

  scrollResponderHandleTouchMove: function scrollResponderHandleTouchMove(e) {
    this.props.onTouchMove && this.props.onTouchMove(e);
  },

  scrollResponderIsAnimating: function scrollResponderIsAnimating() {
    var now = performanceNow();
    var timeSinceLastMomentumScrollEnd = now - this.state.lastMomentumScrollEndTime;
    var isAnimating = timeSinceLastMomentumScrollEnd < IS_ANIMATING_TOUCH_START_THRESHOLD_MS || this.state.lastMomentumScrollEndTime < this.state.lastMomentumScrollBeginTime;
    return isAnimating;
  },

  scrollResponderGetScrollableNode: function scrollResponderGetScrollableNode() {
    return this.getScrollableNode ? this.getScrollableNode() : ReactNative.findNodeHandle(this);
  },

  scrollResponderScrollTo: function scrollResponderScrollTo(x, y, animated) {
    if (typeof x === 'number') {
      console.warn('`scrollResponderScrollTo(x, y, animated)` is deprecated. Use `scrollResponderScrollTo({x: 5, y: 5, animated: true})` instead.');
    } else {
      var _ref = x || {};

      x = _ref.x;
      y = _ref.y;
      animated = _ref.animated;
    }
    UIManager.dispatchViewManagerCommand(nullthrows(this.scrollResponderGetScrollableNode()), UIManager.RCTScrollView.Commands.scrollTo, [x || 0, y || 0, animated !== false]);
  },

  scrollResponderScrollToEnd: function scrollResponderScrollToEnd(options) {
    var animated = (options && options.animated) !== false;
    UIManager.dispatchViewManagerCommand(this.scrollResponderGetScrollableNode(), UIManager.RCTScrollView.Commands.scrollToEnd, [animated]);
  },

  scrollResponderScrollWithoutAnimationTo: function scrollResponderScrollWithoutAnimationTo(offsetX, offsetY) {
    console.warn('`scrollResponderScrollWithoutAnimationTo` is deprecated. Use `scrollResponderScrollTo` instead');
    this.scrollResponderScrollTo({ x: offsetX, y: offsetY, animated: false });
  },

  scrollResponderZoomTo: function scrollResponderZoomTo(rect, animated) {
    invariant(ScrollViewManager && ScrollViewManager.zoomToRect, 'zoomToRect is not implemented');
    if ('animated' in rect) {
      animated = rect.animated;
      delete rect.animated;
    } else if (typeof animated !== 'undefined') {
      console.warn('`scrollResponderZoomTo` `animated` argument is deprecated. Use `options.animated` instead');
    }
    ScrollViewManager.zoomToRect(this.scrollResponderGetScrollableNode(), rect, animated !== false);
  },

  scrollResponderFlashScrollIndicators: function scrollResponderFlashScrollIndicators() {
    UIManager.dispatchViewManagerCommand(this.scrollResponderGetScrollableNode(), UIManager.RCTScrollView.Commands.flashScrollIndicators, []);
  },

  scrollResponderScrollNativeHandleToKeyboard: function scrollResponderScrollNativeHandleToKeyboard(nodeHandle, additionalOffset, preventNegativeScrollOffset) {
    this.additionalScrollOffset = additionalOffset || 0;
    this.preventNegativeScrollOffset = !!preventNegativeScrollOffset;
    UIManager.measureLayout(nodeHandle, ReactNative.findNodeHandle(this.getInnerViewNode()), this.scrollResponderTextInputFocusError, this.scrollResponderInputMeasureAndScrollToKeyboard);
  },

  scrollResponderInputMeasureAndScrollToKeyboard: function scrollResponderInputMeasureAndScrollToKeyboard(left, top, width, height) {
    var keyboardScreenY = Dimensions.get('window').height;
    if (this.keyboardWillOpenTo) {
      keyboardScreenY = this.keyboardWillOpenTo.endCoordinates.screenY;
    }
    var scrollOffsetY = top - keyboardScreenY + height + this.additionalScrollOffset;

    if (this.preventNegativeScrollOffset) {
      scrollOffsetY = Math.max(0, scrollOffsetY);
    }
    this.scrollResponderScrollTo({ x: 0, y: scrollOffsetY, animated: true });

    this.additionalOffset = 0;
    this.preventNegativeScrollOffset = false;
  },

  scrollResponderTextInputFocusError: function scrollResponderTextInputFocusError(e) {
    console.error('Error measuring text field: ', e);
  },

  UNSAFE_componentWillMount: function UNSAFE_componentWillMount() {
    var keyboardShouldPersistTaps = this.props.keyboardShouldPersistTaps;

    warning(typeof keyboardShouldPersistTaps !== 'boolean', '\'keyboardShouldPersistTaps={' + keyboardShouldPersistTaps + '}\' is deprecated. ' + ('Use \'keyboardShouldPersistTaps="' + (keyboardShouldPersistTaps ? 'always' : 'never') + '"\' instead'));

    this.keyboardWillOpenTo = null;
    this.additionalScrollOffset = 0;
    this.addListenerOn(Keyboard, 'keyboardWillShow', this.scrollResponderKeyboardWillShow);
    this.addListenerOn(Keyboard, 'keyboardWillHide', this.scrollResponderKeyboardWillHide);
    this.addListenerOn(Keyboard, 'keyboardDidShow', this.scrollResponderKeyboardDidShow);
    this.addListenerOn(Keyboard, 'keyboardDidHide', this.scrollResponderKeyboardDidHide);
  },

  scrollResponderKeyboardWillShow: function scrollResponderKeyboardWillShow(e) {
    this.keyboardWillOpenTo = e;
    this.props.onKeyboardWillShow && this.props.onKeyboardWillShow(e);
  },

  scrollResponderKeyboardWillHide: function scrollResponderKeyboardWillHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardWillHide && this.props.onKeyboardWillHide(e);
  },

  scrollResponderKeyboardDidShow: function scrollResponderKeyboardDidShow(e) {
    if (e) {
      this.keyboardWillOpenTo = e;
    }
    this.props.onKeyboardDidShow && this.props.onKeyboardDidShow(e);
  },

  scrollResponderKeyboardDidHide: function scrollResponderKeyboardDidHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardDidHide && this.props.onKeyboardDidHide(e);
  }

};

var ScrollResponder = {
  Mixin: ScrollResponderMixin
};

module.exports = ScrollResponder;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNjcm9sbFJlc3BvbmRlci5qcyJdLCJuYW1lcyI6WyJEaW1lbnNpb25zIiwicmVxdWlyZSIsIkZyYW1lUmF0ZUxvZ2dlciIsIktleWJvYXJkIiwiUmVhY3ROYXRpdmUiLCJTdWJzY3JpYmFibGUiLCJUZXh0SW5wdXRTdGF0ZSIsIlVJTWFuYWdlciIsImludmFyaWFudCIsIm51bGx0aHJvd3MiLCJwZXJmb3JtYW5jZU5vdyIsIndhcm5pbmciLCJTY3JvbGxWaWV3TWFuYWdlciIsImdldEluc3RhbmNlRnJvbU5vZGUiLCJJU19BTklNQVRJTkdfVE9VQ0hfU1RBUlRfVEhSRVNIT0xEX01TIiwiaXNUYWdJbnN0YW5jZU9mVGV4dElucHV0IiwidGFnIiwiaW5zdGFuY2UiLCJ2aWV3Q29uZmlnIiwidWlWaWV3Q2xhc3NOYW1lIiwiU2Nyb2xsUmVzcG9uZGVyTWl4aW4iLCJtaXhpbnMiLCJNaXhpbiIsInNjcm9sbFJlc3BvbmRlck1peGluR2V0SW5pdGlhbFN0YXRlIiwiaXNUb3VjaGluZyIsImxhc3RNb21lbnR1bVNjcm9sbEJlZ2luVGltZSIsImxhc3RNb21lbnR1bVNjcm9sbEVuZFRpbWUiLCJvYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXIiLCJiZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbFNob3VsZFNldFJlc3BvbmRlciIsInN0YXRlIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXIiLCJlIiwiY3VycmVudGx5Rm9jdXNlZFRleHRJbnB1dCIsImN1cnJlbnRseUZvY3VzZWRGaWVsZCIsInByb3BzIiwia2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyIsInRhcmdldCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSIsImtleWJvYXJkTmV2ZXJQZXJzaXN0VGFwcyIsInNjcm9sbFJlc3BvbmRlcklzQW5pbWF0aW5nIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVqZWN0Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVGVybWluYXRpb25SZXF1ZXN0Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hFbmQiLCJuYXRpdmVFdmVudCIsInRvdWNoZXMiLCJsZW5ndGgiLCJvblRvdWNoRW5kIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hDYW5jZWwiLCJvblRvdWNoQ2FuY2VsIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZSIsIm9uUmVzcG9uZGVyUmVsZWFzZSIsIm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWQiLCJibHVyVGV4dElucHV0Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsIiwib25TY3JvbGwiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJHcmFudCIsIm9uUmVzcG9uZGVyR3JhbnQiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGxCZWdpbkRyYWciLCJiZWdpblNjcm9sbCIsIm9uU2Nyb2xsQmVnaW5EcmFnIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsRW5kRHJhZyIsInZlbG9jaXR5IiwieCIsInkiLCJlbmRTY3JvbGwiLCJvblNjcm9sbEVuZERyYWciLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVNb21lbnR1bVNjcm9sbEJlZ2luIiwib25Nb21lbnR1bVNjcm9sbEJlZ2luIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlTW9tZW50dW1TY3JvbGxFbmQiLCJvbk1vbWVudHVtU2Nyb2xsRW5kIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hTdGFydCIsIm9uVG91Y2hTdGFydCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoTW92ZSIsIm9uVG91Y2hNb3ZlIiwibm93IiwidGltZVNpbmNlTGFzdE1vbWVudHVtU2Nyb2xsRW5kIiwiaXNBbmltYXRpbmciLCJzY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSIsImdldFNjcm9sbGFibGVOb2RlIiwiZmluZE5vZGVIYW5kbGUiLCJzY3JvbGxSZXNwb25kZXJTY3JvbGxUbyIsImFuaW1hdGVkIiwiY29uc29sZSIsIndhcm4iLCJkaXNwYXRjaFZpZXdNYW5hZ2VyQ29tbWFuZCIsIlJDVFNjcm9sbFZpZXciLCJDb21tYW5kcyIsInNjcm9sbFRvIiwic2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG9FbmQiLCJvcHRpb25zIiwic2Nyb2xsVG9FbmQiLCJzY3JvbGxSZXNwb25kZXJTY3JvbGxXaXRob3V0QW5pbWF0aW9uVG8iLCJvZmZzZXRYIiwib2Zmc2V0WSIsInNjcm9sbFJlc3BvbmRlclpvb21UbyIsInJlY3QiLCJ6b29tVG9SZWN0Iiwic2Nyb2xsUmVzcG9uZGVyRmxhc2hTY3JvbGxJbmRpY2F0b3JzIiwiZmxhc2hTY3JvbGxJbmRpY2F0b3JzIiwic2Nyb2xsUmVzcG9uZGVyU2Nyb2xsTmF0aXZlSGFuZGxlVG9LZXlib2FyZCIsIm5vZGVIYW5kbGUiLCJhZGRpdGlvbmFsT2Zmc2V0IiwicHJldmVudE5lZ2F0aXZlU2Nyb2xsT2Zmc2V0IiwiYWRkaXRpb25hbFNjcm9sbE9mZnNldCIsIm1lYXN1cmVMYXlvdXQiLCJnZXRJbm5lclZpZXdOb2RlIiwic2Nyb2xsUmVzcG9uZGVyVGV4dElucHV0Rm9jdXNFcnJvciIsInNjcm9sbFJlc3BvbmRlcklucHV0TWVhc3VyZUFuZFNjcm9sbFRvS2V5Ym9hcmQiLCJsZWZ0IiwidG9wIiwid2lkdGgiLCJoZWlnaHQiLCJrZXlib2FyZFNjcmVlblkiLCJnZXQiLCJrZXlib2FyZFdpbGxPcGVuVG8iLCJlbmRDb29yZGluYXRlcyIsInNjcmVlblkiLCJzY3JvbGxPZmZzZXRZIiwiTWF0aCIsIm1heCIsImVycm9yIiwiVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCIsImFkZExpc3RlbmVyT24iLCJzY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxTaG93Iiwic2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZSIsInNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkU2hvdyIsInNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkSGlkZSIsIm9uS2V5Ym9hcmRXaWxsU2hvdyIsIm9uS2V5Ym9hcmRXaWxsSGlkZSIsIm9uS2V5Ym9hcmREaWRTaG93Iiwib25LZXlib2FyZERpZEhpZGUiLCJTY3JvbGxSZXNwb25kZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiO0FBU0E7O0FBRUEsSUFBTUEsYUFBYUMsUUFBUSxZQUFSLENBQW5CO0FBQ0EsSUFBTUMsa0JBQWtCRCxRQUFRLGlCQUFSLENBQXhCO0FBQ0EsSUFBTUUsV0FBV0YsUUFBUSxVQUFSLENBQWpCO0FBQ0EsSUFBTUcsY0FBY0gsUUFBUSxhQUFSLENBQXBCO0FBQ0EsSUFBTUksZUFBZUosUUFBUSxjQUFSLENBQXJCO0FBQ0EsSUFBTUssaUJBQWlCTCxRQUFRLGdCQUFSLENBQXZCO0FBQ0EsSUFBTU0sWUFBWU4sUUFBUSxXQUFSLENBQWxCOztBQUVBLElBQU1PLFlBQVlQLFFBQVEsb0JBQVIsQ0FBbEI7QUFDQSxJQUFNUSxhQUFhUixRQUFRLHFCQUFSLENBQW5CO0FBQ0EsSUFBTVMsaUJBQWlCVCxRQUFRLHlCQUFSLENBQXZCO0FBQ0EsSUFBTVUsVUFBVVYsUUFBUSxrQkFBUixDQUFoQjs7ZUFFOEJBLFFBQVEsZUFBUixDO0lBQXRCVyxpQixZQUFBQSxpQjs7Z0JBQ3dCWCxRQUFRLDBCQUFSLEM7SUFBeEJZLG1CLGFBQUFBLG1COztBQWdGUixJQUFNQyx3Q0FBd0MsRUFBOUM7O0FBV0EsU0FBU0Msd0JBQVQsQ0FBa0NDLEdBQWxDLEVBQXVDO0FBQ3JDLE1BQU1DLFdBQVdKLG9CQUFvQkcsR0FBcEIsQ0FBakI7QUFDQSxTQUFPQyxZQUFZQSxTQUFTQyxVQUFyQixLQUNMRCxTQUFTQyxVQUFULENBQW9CQyxlQUFwQixLQUF3QyxrQkFBeEMsSUFDQUYsU0FBU0MsVUFBVCxDQUFvQkMsZUFBcEIsS0FBd0MsMkJBRHhDLElBRUFGLFNBQVNDLFVBQVQsQ0FBb0JDLGVBQXBCLEtBQXdD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QWdELEtBQUs0SCw4QkFBckQ7QUFDRCxHQXJiMEI7O0FBbWQzQkgsbUNBQWlDLHlDQUFTNUYsQ0FBVCxFQUFtQjtBQUNsRCxTQUFLbUYsa0JBQUwsR0FBMEJuRixDQUExQjtBQUNBLFNBQUtHLEtBQUwsQ0FBVzZGLGtCQUFYLElBQWlDLEtBQUs3RixLQUFMLENBQVc2RixrQkFBWCxDQUE4QmhHLENBQTlCLENBQWpDO0FBQ0QsR0F0ZDBCOztBQXdkM0I2RixtQ0FBaUMseUNBQVM3RixDQUFULEVBQW1CO0FBQ2xELFNBQUttRixrQkFBTCxHQUEwQixJQUExQjtBQUNBLFNBQUtoRixLQUFMLENBQVc4RixrQkFBWCxJQUFpQyxLQUFLOUYsS0FBTCxDQUFXOEYsa0JBQVgsQ0FBOEJqRyxDQUE5QixDQUFqQztBQUNELEdBM2QwQjs7QUE2ZDNCOEYsa0NBQWdDLHdDQUFTOUYsQ0FBVCxFQUFtQjtBQUdqRCxRQUFJQSxDQUFKLEVBQU87QUFDTCxXQUFLbUYsa0JBQUwsR0FBMEJuRixDQUExQjtBQUNEO0FBQ0QsU0FBS0csS0FBTCxDQUFXK0YsaUJBQVgsSUFBZ0MsS0FBSy9GLEtBQUwsQ0FBVytGLGlCQUFYLENBQTZCbEcsQ0FBN0IsQ0FBaEM7QUFDRCxHQXBlMEI7O0FBc2UzQitGLGtDQUFnQyx3Q0FBUy9GLENBQVQsRUFBbUI7QUFDakQsU0FBS21GLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsU0FBS2hGLEtBQUwsQ0FBV2dHLGlCQUFYLElBQWdDLEtBQUtoRyxLQUFMLENBQVdnRyxpQkFBWCxDQUE2Qm5HLENBQTdCLENBQWhDO0FBQ0Q7O0FBemUwQixDQUE3Qjs7QUE2ZUEsSUFBTW9HLGtCQUFrQjtBQUN0QjlHLFNBQU9GO0FBRGUsQ0FBeEI7O0FBSUFpSCxPQUFPQyxPQUFQLEdBQWlCRixlQUFqQiIsImZpbGUiOiJTY3JvbGxSZXNwb25kZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBTY3JvbGxSZXNwb25kZXJcbiAqIEBmbG93XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgRGltZW5zaW9ucyA9IHJlcXVpcmUoJ0RpbWVuc2lvbnMnKTtcbmNvbnN0IEZyYW1lUmF0ZUxvZ2dlciA9IHJlcXVpcmUoJ0ZyYW1lUmF0ZUxvZ2dlcicpO1xuY29uc3QgS2V5Ym9hcmQgPSByZXF1aXJlKCdLZXlib2FyZCcpO1xuY29uc3QgUmVhY3ROYXRpdmUgPSByZXF1aXJlKCdSZWFjdE5hdGl2ZScpO1xuY29uc3QgU3Vic2NyaWJhYmxlID0gcmVxdWlyZSgnU3Vic2NyaWJhYmxlJyk7XG5jb25zdCBUZXh0SW5wdXRTdGF0ZSA9IHJlcXVpcmUoJ1RleHRJbnB1dFN0YXRlJyk7XG5jb25zdCBVSU1hbmFnZXIgPSByZXF1aXJlKCdVSU1hbmFnZXInKTtcblxuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnZmJqcy9saWIvaW52YXJpYW50Jyk7XG5jb25zdCBudWxsdGhyb3dzID0gcmVxdWlyZSgnZmJqcy9saWIvbnVsbHRocm93cycpO1xuY29uc3QgcGVyZm9ybWFuY2VOb3cgPSByZXF1aXJlKCdmYmpzL2xpYi9wZXJmb3JtYW5jZU5vdycpO1xuY29uc3Qgd2FybmluZyA9IHJlcXVpcmUoJ2ZianMvbGliL3dhcm5pbmcnKTtcblxuY29uc3QgeyBTY3JvbGxWaWV3TWFuYWdlciB9ID0gcmVxdWlyZSgnTmF0aXZlTW9kdWxlcycpO1xuY29uc3QgeyBnZXRJbnN0YW5jZUZyb21Ob2RlIH0gPSByZXF1aXJlKCdSZWFjdE5hdGl2ZUNvbXBvbmVudFRyZWUnKTtcblxuLyoqXG4gKiBNaXhpbiB0aGF0IGNhbiBiZSBpbnRlZ3JhdGVkIGluIG9yZGVyIHRvIGhhbmRsZSBzY3JvbGxpbmcgdGhhdCBwbGF5cyB3ZWxsXG4gKiB3aXRoIGBSZXNwb25kZXJFdmVudFBsdWdpbmAuIEludGVncmF0ZSB3aXRoIHlvdXIgcGxhdGZvcm0gc3BlY2lmaWMgc2Nyb2xsXG4gKiB2aWV3cywgb3IgZXZlbiB5b3VyIGN1c3RvbSBidWlsdCAoZXZlcnktZnJhbWUgYW5pbWF0aW5nKSBzY3JvbGwgdmlld3Mgc28gdGhhdFxuICogYWxsIG9mIHRoZXNlIHN5c3RlbXMgcGxheSB3ZWxsIHdpdGggdGhlIGBSZXNwb25kZXJFdmVudFBsdWdpbmAuXG4gKlxuICogaU9TIHNjcm9sbCBldmVudCB0aW1pbmcgbnVhbmNlczpcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqXG4gKlxuICogU2Nyb2xsaW5nIHdpdGhvdXQgYm91bmNpbmcsIGlmIHlvdSB0b3VjaCBkb3duOlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICpcbiAqIDEuIGBvbk1vbWVudHVtU2Nyb2xsQmVnaW5gICh3aGVuIGFuaW1hdGlvbiBiZWdpbnMgYWZ0ZXIgbGV0dGluZyB1cClcbiAqICAgIC4uLiBwaHlzaWNhbCB0b3VjaCBzdGFydHMgLi4uXG4gKiAyLiBgb25Ub3VjaFN0YXJ0Q2FwdHVyZWAgICAod2hlbiB5b3UgcHJlc3MgZG93biB0byBzdG9wIHRoZSBzY3JvbGwpXG4gKiAzLiBgb25Ub3VjaFN0YXJ0YCAgICAgICAgICAoc2FtZSwgYnV0IGJ1YmJsZSBwaGFzZSlcbiAqIDQuIGBvblJlc3BvbmRlclJlbGVhc2VgICAgICh3aGVuIGxpZnRpbmcgdXAgLSB5b3UgY291bGQgcGF1c2UgZm9yZXZlciBiZWZvcmUgKiBsaWZ0aW5nKVxuICogNS4gYG9uTW9tZW50dW1TY3JvbGxFbmRgXG4gKlxuICpcbiAqIFNjcm9sbGluZyB3aXRoIGJvdW5jaW5nLCBpZiB5b3UgdG91Y2ggZG93bjpcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiAxLiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCAod2hlbiBhbmltYXRpb24gYmVnaW5zIGFmdGVyIGxldHRpbmcgdXApXG4gKiAgICAuLi4gYm91bmNlIGJlZ2lucyAuLi5cbiAqICAgIC4uLiBzb21lIHRpbWUgZWxhcHNlcyAuLi5cbiAqICAgIC4uLiBwaHlzaWNhbCB0b3VjaCBkdXJpbmcgYm91bmNlIC4uLlxuICogMi4gYG9uTW9tZW50dW1TY3JvbGxFbmRgICAgKE1ha2VzIG5vIHNlbnNlIHdoeSB0aGlzIG9jY3VycyBmaXJzdCBkdXJpbmcgYm91bmNlKVxuICogMy4gYG9uVG91Y2hTdGFydENhcHR1cmVgICAgKGltbWVkaWF0ZWx5IGFmdGVyIGBvbk1vbWVudHVtU2Nyb2xsRW5kYClcbiAqIDQuIGBvblRvdWNoU3RhcnRgICAgICAgICAgIChzYW1lLCBidXQgYnViYmxlIHBoYXNlKVxuICogNS4gYG9uVG91Y2hFbmRgICAgICAgICAgICAgKFlvdSBjb3VsZCBob2xkIHRoZSB0b3VjaCBzdGFydCBmb3IgYSBsb25nIHRpbWUpXG4gKiA2LiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCAoV2hlbiByZWxlYXNpbmcgdGhlIHZpZXcgc3RhcnRzIGJvdW5jaW5nIGJhY2spXG4gKlxuICogU28gd2hlbiB3ZSByZWNlaXZlIGFuIGBvblRvdWNoU3RhcnRgLCBob3cgY2FuIHdlIHRlbGwgaWYgd2UgYXJlIHRvdWNoaW5nXG4gKiAqZHVyaW5nKiBhbiBhbmltYXRpb24gKHdoaWNoIHRoZW4gY2F1c2VzIHRoZSBhbmltYXRpb24gdG8gc3RvcCk/IFRoZSBvbmx5IHdheVxuICogdG8gdGVsbCBpcyBpZiB0aGUgYHRvdWNoU3RhcnRgIG9jY3VycmVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZVxuICogYG9uTW9tZW50dW1TY3JvbGxFbmRgLlxuICpcbiAqIFRoaXMgaXMgYWJzdHJhY3RlZCBvdXQgZm9yIHlvdSwgc28geW91IGNhbiBqdXN0IGNhbGwgdGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpIGlmXG4gKiBuZWNlc3NhcnlcbiAqXG4gKiBgU2Nyb2xsUmVzcG9uZGVyYCBhbHNvIGluY2x1ZGVzIGxvZ2ljIGZvciBibHVycmluZyBhIGN1cnJlbnRseSBmb2N1c2VkIGlucHV0XG4gKiBpZiBvbmUgaXMgZm9jdXNlZCB3aGlsZSBzY3JvbGxpbmcuIFRoZSBgU2Nyb2xsUmVzcG9uZGVyYCBpcyBhIG5hdHVyYWwgcGxhY2VcbiAqIHRvIHB1dCB0aGlzIGxvZ2ljIHNpbmNlIGl0IGNhbiBzdXBwb3J0IG5vdCBkaXNtaXNzaW5nIHRoZSBrZXlib2FyZCB3aGlsZVxuICogc2Nyb2xsaW5nLCB1bmxlc3MgYSByZWNvZ25pemVkIFwidGFwXCItbGlrZSBnZXN0dXJlIGhhcyBvY2N1cnJlZC5cbiAqXG4gKiBUaGUgcHVibGljIGxpZmVjeWNsZSBBUEkgaW5jbHVkZXMgZXZlbnRzIGZvciBrZXlib2FyZCBpbnRlcmFjdGlvbiwgcmVzcG9uZGVyXG4gKiBpbnRlcmFjdGlvbiwgYW5kIHNjcm9sbGluZyAoYW1vbmcgb3RoZXJzKS4gVGhlIGtleWJvYXJkIGNhbGxiYWNrc1xuICogYG9uS2V5Ym9hcmRXaWxsL0RpZC8qYCBhcmUgKmdsb2JhbCogZXZlbnRzLCBidXQgYXJlIGludm9rZWQgb24gc2Nyb2xsXG4gKiByZXNwb25kZXIncyBwcm9wcyBzbyB0aGF0IHlvdSBjYW4gZ3VhcmFudGVlIHRoYXQgdGhlIHNjcm9sbCByZXNwb25kZXInc1xuICogaW50ZXJuYWwgc3RhdGUgaGFzIGJlZW4gdXBkYXRlZCBhY2NvcmRpbmdseSAoYW5kIGRldGVybWluaXN0aWNhbGx5KSBieVxuICogdGhlIHRpbWUgdGhlIHByb3BzIGNhbGxiYWNrcyBhcmUgaW52b2tlLiBPdGhlcndpc2UsIHlvdSB3b3VsZCBhbHdheXMgd29uZGVyXG4gKiBpZiB0aGUgc2Nyb2xsIHJlc3BvbmRlciBpcyBjdXJyZW50bHkgaW4gYSBzdGF0ZSB3aGVyZSBpdCByZWNvZ25pemVzIG5ld1xuICoga2V5Ym9hcmQgcG9zaXRpb25zIGV0Yy4gSWYgY29vcmRpbmF0aW5nIHNjcm9sbGluZyB3aXRoIGtleWJvYXJkIG1vdmVtZW50LFxuICogKmFsd2F5cyogdXNlIHRoZXNlIGhvb2tzIGluc3RlYWQgb2YgbGlzdGVuaW5nIHRvIHlvdXIgb3duIGdsb2JhbCBrZXlib2FyZFxuICogZXZlbnRzLlxuICpcbiAqIFB1YmxpYyBrZXlib2FyZCBsaWZlY3ljbGUgQVBJOiAocHJvcHMgY2FsbGJhY2tzKVxuICpcbiAqIFN0YW5kYXJkIEtleWJvYXJkIEFwcGVhcmFuY2UgU2VxdWVuY2U6XG4gKlxuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvd1xuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRTaG93XG4gKlxuICogYG9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWRgIHdpbGwgYmUgaW52b2tlZCBpZiBhbiBhcHByb3ByaWF0ZVxuICogdGFwIGluc2lkZSB0aGUgc2Nyb2xsIHJlc3BvbmRlcidzIHNjcm9sbGFibGUgcmVnaW9uIHdhcyByZXNwb25zaWJsZVxuICogZm9yIHRoZSBkaXNtaXNzYWwgb2YgdGhlIGtleWJvYXJkLiBUaGVyZSBhcmUgb3RoZXIgcmVhc29ucyB3aHkgdGhlXG4gKiBrZXlib2FyZCBjb3VsZCBiZSBkaXNtaXNzZWQuXG4gKlxuICogICB0aGlzLnByb3BzLm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWRcbiAqXG4gKiBTdGFuZGFyZCBLZXlib2FyZCBIaWRlIFNlcXVlbmNlOlxuICpcbiAqICAgdGhpcy5wcm9wcy5vbktleWJvYXJkV2lsbEhpZGVcbiAqICAgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkSGlkZVxuICovXG5cbmNvbnN0IElTX0FOSU1BVElOR19UT1VDSF9TVEFSVF9USFJFU0hPTERfTVMgPSAxNjtcblxudHlwZSBTdGF0ZSA9IHtcbiAgICBpc1RvdWNoaW5nOiBib29sZWFuLFxuICAgIGxhc3RNb21lbnR1bVNjcm9sbEJlZ2luVGltZTogbnVtYmVyLFxuICAgIGxhc3RNb21lbnR1bVNjcm9sbEVuZFRpbWU6IG51bWJlcixcbiAgICBvYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXI6IGJvb2xlYW4sXG4gICAgYmVjYW1lUmVzcG9uZGVyV2hpbGVBbmltYXRpbmc6IGJvb2xlYW4sXG59O1xudHlwZSBFdmVudCA9IE9iamVjdDtcblxuZnVuY3Rpb24gaXNUYWdJbnN0YW5jZU9mVGV4dElucHV0KHRhZykge1xuICBjb25zdCBpbnN0YW5jZSA9IGdldEluc3RhbmNlRnJvbU5vZGUodGFnKTtcbiAgcmV0dXJuIGluc3RhbmNlICYmIGluc3RhbmNlLnZpZXdDb25maWcgJiYgKFxuICAgIGluc3RhbmNlLnZpZXdDb25maWcudWlWaWV3Q2xhc3NOYW1lID09PSAnQW5kcm9pZFRleHRJbnB1dCcgfHxcbiAgICBpbnN0YW5jZS52aWV3Q29uZmlnLnVpVmlld0NsYXNzTmFtZSA9PT0gJ1JDVE11bHRpbGluZVRleHRJbnB1dFZpZXcnIHx8XG4gICAgaW5zdGFuY2Uudmlld0NvbmZpZy51aVZpZXdDbGFzc05hbWUgPT09ICdSQ1RTaW5nbGVsaW5lVGV4dElucHV0VmlldydcbiAgKTtcbn1cblxuY29uc3QgU2Nyb2xsUmVzcG9uZGVyTWl4aW4gPSB7XG4gIG1peGluczogW1N1YnNjcmliYWJsZS5NaXhpbl0sXG4gIHNjcm9sbFJlc3BvbmRlck1peGluR2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpOiBTdGF0ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVG91Y2hpbmc6IGZhbHNlLFxuICAgICAgbGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lOiAwLFxuICAgICAgbGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZTogMCxcblxuICAgICAgLy8gUmVzZXQgdG8gZmFsc2UgZXZlcnkgdGltZSBiZWNvbWVzIHJlc3BvbmRlci4gVGhpcyBpcyB1c2VkIHRvOlxuICAgICAgLy8gLSBEZXRlcm1pbmUgaWYgdGhlIHNjcm9sbCB2aWV3IGhhcyBiZWVuIHNjcm9sbGVkIGFuZCB0aGVyZWZvcmUgc2hvdWxkXG4gICAgICAvLyByZWZ1c2UgdG8gZ2l2ZSB1cCBpdHMgcmVzcG9uZGVyIGxvY2suXG4gICAgICAvLyAtIERldGVybWluZSBpZiByZWxlYXNpbmcgc2hvdWxkIGRpc21pc3MgdGhlIGtleWJvYXJkIHdoZW4gd2UgYXJlIGluXG4gICAgICAvLyB0YXAtdG8tZGlzbWlzcyBtb2RlICh0aGlzLnByb3BzLmtleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHMgIT09ICdhbHdheXMnKS5cbiAgICAgIG9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlcjogZmFsc2UsXG4gICAgICBiZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZzogZmFsc2UsXG4gICAgfTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25TY3JvbGxgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyOiBmdW5jdGlvbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pc1RvdWNoaW5nO1xuICB9LFxuXG4gIC8qKlxuICAgKiBNZXJlbHkgdG91Y2ggc3RhcnRpbmcgaXMgbm90IHN1ZmZpY2llbnQgZm9yIGEgc2Nyb2xsIHZpZXcgdG8gYmVjb21lIHRoZVxuICAgKiByZXNwb25kZXIuIEJlaW5nIHRoZSBcInJlc3BvbmRlclwiIG1lYW5zIHRoYXQgdGhlIHZlcnkgbmV4dCB0b3VjaCBtb3ZlL2VuZFxuICAgKiBldmVudCB3aWxsIHJlc3VsdCBpbiBhbiBhY3Rpb24vbW92ZW1lbnQuXG4gICAqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJgIGV2ZW50LlxuICAgKlxuICAgKiBgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcmAgaXMgdXNlZCB3aGVuIHRoZSBuZXh0IG1vdmUvZW5kIHdpbGwgdHJpZ2dlclxuICAgKiBzb21lIFVJIG1vdmVtZW50L2FjdGlvbiwgYnV0IHdoZW4geW91IHdhbnQgdG8geWllbGQgcHJpb3JpdHkgdG8gdmlld3NcbiAgICogbmVzdGVkIGluc2lkZSBvZiB0aGUgdmlldy5cbiAgICpcbiAgICogVGhlcmUgbWF5IGJlIHNvbWUgY2FzZXMgd2hlcmUgc2Nyb2xsIHZpZXdzIGFjdHVhbGx5IHNob3VsZCByZXR1cm4gYHRydWVgXG4gICAqIGZyb20gYG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJgOiBBbnkgdGltZSB3ZSBhcmUgZGV0ZWN0aW5nIGEgc3RhbmRhcmQgdGFwXG4gICAqIHRoYXQgZ2l2ZXMgcHJpb3JpdHkgdG8gbmVzdGVkIHZpZXdzLlxuICAgKlxuICAgKiAtIElmIGEgc2luZ2xlIHRhcCBvbiB0aGUgc2Nyb2xsIHZpZXcgdHJpZ2dlcnMgYW4gYWN0aW9uIHN1Y2ggYXNcbiAgICogICByZWNlbnRlcmluZyBhIG1hcCBzdHlsZSB2aWV3IHlldCB3YW50cyB0byBnaXZlIHByaW9yaXR5IHRvIGludGVyYWN0aW9uXG4gICAqICAgdmlld3MgaW5zaWRlIChzdWNoIGFzIGRyb3BwZWQgcGlucyBvciBsYWJlbHMpLCB0aGVuIHdlIHdvdWxkIHJldHVybiB0cnVlXG4gICAqICAgZnJvbSB0aGlzIG1ldGhvZCB3aGVuIHRoZXJlIGlzIGEgc2luZ2xlIHRvdWNoLlxuICAgKlxuICAgKiAtIFNpbWlsYXIgdG8gdGhlIHByZXZpb3VzIGNhc2UsIGlmIGEgdHdvIGZpbmdlciBcInRhcFwiIHNob3VsZCB0cmlnZ2VyIGFcbiAgICogICB6b29tLCB3ZSB3b3VsZCBjaGVjayB0aGUgYHRvdWNoZXNgIGNvdW50LCBhbmQgaWYgYD49IDJgLCB3ZSB3b3VsZCByZXR1cm5cbiAgICogICB0cnVlLlxuICAgKlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXI6IGZ1bmN0aW9uKGU6IEV2ZW50KTogYm9vbGVhbiB7XG4gICAgY29uc3QgY3VycmVudGx5Rm9jdXNlZFRleHRJbnB1dCA9IFRleHRJbnB1dFN0YXRlLmN1cnJlbnRseUZvY3VzZWRGaWVsZCgpO1xuXG4gICAgaWYgKHRoaXMucHJvcHMua2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyA9PT0gJ2hhbmRsZWQnICYmXG4gICAgICBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ICE9IG51bGwgJiZcbiAgICAgIGUudGFyZ2V0ICE9PSBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGVyZSBhcmUgdGltZXMgd2hlbiB0aGUgc2Nyb2xsIHZpZXcgd2FudHMgdG8gYmVjb21lIHRoZSByZXNwb25kZXJcbiAgICogKG1lYW5pbmcgcmVzcG9uZCB0byB0aGUgbmV4dCBpbW1lZGlhdGUgYHRvdWNoU3RhcnQvdG91Y2hFbmRgKSwgaW4gYSB3YXlcbiAgICogdGhhdCAqZG9lc24ndCogZ2l2ZSBwcmlvcml0eSB0byBuZXN0ZWQgdmlld3MgKGhlbmNlIHRoZSBjYXB0dXJlIHBoYXNlKTpcbiAgICpcbiAgICogLSBDdXJyZW50bHkgYW5pbWF0aW5nLlxuICAgKiAtIFRhcHBpbmcgYW55d2hlcmUgdGhhdCBpcyBub3QgYSB0ZXh0IGlucHV0LCB3aGlsZSB0aGUga2V5Ym9hcmQgaXNcbiAgICogICB1cCAod2hpY2ggc2hvdWxkIGRpc21pc3MgdGhlIGtleWJvYXJkKS5cbiAgICpcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmVgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlOiBmdW5jdGlvbihlOiBFdmVudCk6IGJvb2xlYW4ge1xuICAgIC8vIEZpcnN0IHNlZSBpZiB3ZSB3YW50IHRvIGVhdCB0YXBzIHdoaWxlIHRoZSBrZXlib2FyZCBpcyB1cFxuICAgIGNvbnN0IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgPSBUZXh0SW5wdXRTdGF0ZS5jdXJyZW50bHlGb2N1c2VkRmllbGQoKTtcbiAgICBjb25zdCB7a2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwc30gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGtleWJvYXJkTmV2ZXJQZXJzaXN0VGFwcyA9ICFrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzID09PSAnbmV2ZXInO1xuICAgIGlmIChrZXlib2FyZE5ldmVyUGVyc2lzdFRhcHMgJiZcbiAgICAgIGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgIT0gbnVsbCAmJlxuICAgICAgIWlzVGFnSW5zdGFuY2VPZlRleHRJbnB1dChlLnRhcmdldCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblJlc3BvbmRlclJlamVjdGAgZXZlbnQuXG4gICAqXG4gICAqIFNvbWUgb3RoZXIgZWxlbWVudCBpcyBub3QgeWllbGRpbmcgaXRzIHJvbGUgYXMgcmVzcG9uZGVyLiBOb3JtYWxseSwgd2UnZFxuICAgKiBqdXN0IGRpc2FibGUgdGhlIGBVSVNjcm9sbFZpZXdgLCBidXQgYSB0b3VjaCBoYXMgYWxyZWFkeSBiZWdhbiBvbiBpdCwgdGhlXG4gICAqIGBVSVNjcm9sbFZpZXdgIHdpbGwgbm90IGFjY2VwdCBiZWluZyBkaXNhYmxlZCBhZnRlciB0aGF0LiBUaGUgZWFzaWVzdFxuICAgKiBzb2x1dGlvbiBmb3Igbm93IGlzIHRvIGFjY2VwdCB0aGUgbGltaXRhdGlvbiBvZiBkaXNhbGxvd2luZyB0aGlzXG4gICAqIGFsdG9nZXRoZXIuIFRvIGltcHJvdmUgdGhpcywgZmluZCBhIHdheSB0byBkaXNhYmxlIHRoZSBgVUlTY3JvbGxWaWV3YCBhZnRlclxuICAgKiBhIHRvdWNoIGhhcyBhbHJlYWR5IHN0YXJ0ZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWplY3Q6IGZ1bmN0aW9uKCkge1xuICB9LFxuXG4gIC8qKlxuICAgKiBXZSB3aWxsIGFsbG93IHRoZSBzY3JvbGwgdmlldyB0byBnaXZlIHVwIGl0cyBsb2NrIGlmZiBpdCBhY3F1aXJlZCB0aGUgbG9ja1xuICAgKiBkdXJpbmcgYW4gYW5pbWF0aW9uLiBUaGlzIGlzIGEgdmVyeSB1c2VmdWwgZGVmYXVsdCB0aGF0IGhhcHBlbnMgdG8gc2F0aXNmeVxuICAgKiBtYW55IGNvbW1vbiB1c2VyIGV4cGVyaWVuY2VzLlxuICAgKlxuICAgKiAtIFN0b3AgYSBzY3JvbGwgb24gdGhlIGxlZnQgZWRnZSwgdGhlbiB0dXJuIHRoYXQgaW50byBhbiBvdXRlciB2aWV3J3NcbiAgICogICBiYWNrc3dpcGUuXG4gICAqIC0gU3RvcCBhIHNjcm9sbCBtaWQtYm91bmNlIGF0IHRoZSB0b3AsIGNvbnRpbnVlIHB1bGxpbmcgdG8gaGF2ZSB0aGUgb3V0ZXJcbiAgICogICB2aWV3IGRpc21pc3MuXG4gICAqIC0gSG93ZXZlciwgd2l0aG91dCBjYXRjaGluZyB0aGUgc2Nyb2xsIHZpZXcgbWlkLWJvdW5jZSAod2hpbGUgaXQgaXNcbiAgICogICBtb3Rpb25sZXNzKSwgaWYgeW91IGRyYWcgZmFyIGVub3VnaCBmb3IgdGhlIHNjcm9sbCB2aWV3IHRvIGJlY29tZVxuICAgKiAgIHJlc3BvbmRlciAoYW5kIHRoZXJlZm9yZSBkcmFnIHRoZSBzY3JvbGwgdmlldyBhIGJpdCksIGFueSBiYWNrc3dpcGVcbiAgICogICBuYXZpZ2F0aW9uIG9mIGEgc3dpcGUgZ2VzdHVyZSBoaWdoZXIgaW4gdGhlIHZpZXcgaGllcmFyY2h5LCBzaG91bGQgYmVcbiAgICogICByZWplY3RlZC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRlcm1pbmF0aW9uUmVxdWVzdDogZnVuY3Rpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlcjtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Ub3VjaEVuZGAgZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7U3ludGhldGljRXZlbnR9IGUgRXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaEVuZDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBjb25zdCBuYXRpdmVFdmVudCA9IGUubmF0aXZlRXZlbnQ7XG4gICAgdGhpcy5zdGF0ZS5pc1RvdWNoaW5nID0gbmF0aXZlRXZlbnQudG91Y2hlcy5sZW5ndGggIT09IDA7XG4gICAgdGhpcy5wcm9wcy5vblRvdWNoRW5kICYmIHRoaXMucHJvcHMub25Ub3VjaEVuZChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Ub3VjaENhbmNlbGAgZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7U3ludGhldGljRXZlbnR9IGUgRXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaENhbmNlbDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLnN0YXRlLmlzVG91Y2hpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnByb3BzLm9uVG91Y2hDYW5jZWwgJiYgdGhpcy5wcm9wcy5vblRvdWNoQ2FuY2VsKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblJlc3BvbmRlclJlbGVhc2VgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZTogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyUmVsZWFzZSAmJiB0aGlzLnByb3BzLm9uUmVzcG9uZGVyUmVsZWFzZShlKTtcblxuICAgIC8vIEJ5IGRlZmF1bHQgc2Nyb2xsIHZpZXdzIHdpbGwgdW5mb2N1cyBhIHRleHRGaWVsZFxuICAgIC8vIGlmIGFub3RoZXIgdG91Y2ggb2NjdXJzIG91dHNpZGUgb2YgaXRcbiAgICBjb25zdCBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ID0gVGV4dElucHV0U3RhdGUuY3VycmVudGx5Rm9jdXNlZEZpZWxkKCk7XG4gICAgaWYgKHRoaXMucHJvcHMua2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyAhPT0gdHJ1ZSAmJlxuICAgICAgdGhpcy5wcm9wcy5rZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzICE9PSAnYWx3YXlzJyAmJlxuICAgICAgY3VycmVudGx5Rm9jdXNlZFRleHRJbnB1dCAhPSBudWxsICYmXG4gICAgICBlLnRhcmdldCAhPT0gY3VycmVudGx5Rm9jdXNlZFRleHRJbnB1dCAgJiZcbiAgICAgICF0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciAmJlxuICAgICAgIXRoaXMuc3RhdGUuYmVjYW1lUmVzcG9uZGVyV2hpbGVBbmltYXRpbmcpIHtcbiAgICAgIHRoaXMucHJvcHMub25TY3JvbGxSZXNwb25kZXJLZXlib2FyZERpc21pc3NlZCAmJlxuICAgICAgICB0aGlzLnByb3BzLm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWQoZSk7XG4gICAgICBUZXh0SW5wdXRTdGF0ZS5ibHVyVGV4dElucHV0KGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQpO1xuICAgIH1cbiAgfSxcblxuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGw6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5zdGF0ZS5vYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXIgPSB0cnVlO1xuICAgIHRoaXMucHJvcHMub25TY3JvbGwgJiYgdGhpcy5wcm9wcy5vblNjcm9sbChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25SZXNwb25kZXJHcmFudGAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJHcmFudDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciA9IGZhbHNlO1xuICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJHcmFudCAmJiB0aGlzLnByb3BzLm9uUmVzcG9uZGVyR3JhbnQoZSk7XG4gICAgdGhpcy5zdGF0ZS5iZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZyA9IHRoaXMuc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmcoKTtcbiAgfSxcblxuICAvKipcbiAgICogVW5mb3J0dW5hdGVseSwgYG9uU2Nyb2xsQmVnaW5EcmFnYCBhbHNvIGZpcmVzIHdoZW4gKnN0b3BwaW5nKiB0aGUgc2Nyb2xsXG4gICAqIGFuaW1hdGlvbiwgYW5kIHRoZXJlJ3Mgbm90IGFuIGVhc3kgd2F5IHRvIGRpc3Rpbmd1aXNoIGEgZHJhZyB2cy4gc3RvcHBpbmdcbiAgICogbW9tZW50dW0uXG4gICAqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU2Nyb2xsQmVnaW5EcmFnYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZzogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBGcmFtZVJhdGVMb2dnZXIuYmVnaW5TY3JvbGwoKTsgLy8gVE9ETzogdHJhY2sgYWxsIHNjcm9sbHMgYWZ0ZXIgaW1wbGVtZW50aW5nIG9uU2Nyb2xsRW5kQW5pbWF0aW9uXG4gICAgdGhpcy5wcm9wcy5vblNjcm9sbEJlZ2luRHJhZyAmJiB0aGlzLnByb3BzLm9uU2Nyb2xsQmVnaW5EcmFnKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblNjcm9sbEVuZERyYWdgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsRW5kRHJhZzogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBjb25zdCB7dmVsb2NpdHl9ID0gZS5uYXRpdmVFdmVudDtcbiAgICAvLyAtIElmIHdlIGFyZSBhbmltYXRpbmcsIHRoZW4gdGhpcyBpcyBhIFwiZHJhZ1wiIHRoYXQgaXMgc3RvcHBpbmcgdGhlIHNjcm9sbHZpZXcgYW5kIG1vbWVudHVtIGVuZFxuICAgIC8vICAgd2lsbCBmaXJlLlxuICAgIC8vIC0gSWYgdmVsb2NpdHkgaXMgbm9uLXplcm8sIHRoZW4gdGhlIGludGVyYWN0aW9uIHdpbGwgc3RvcCB3aGVuIG1vbWVudHVtIHNjcm9sbCBlbmRzIG9yXG4gICAgLy8gICBhbm90aGVyIGRyYWcgc3RhcnRzIGFuZCBlbmRzLlxuICAgIC8vIC0gSWYgd2UgZG9uJ3QgZ2V0IHZlbG9jaXR5LCBiZXR0ZXIgdG8gc3RvcCB0aGUgaW50ZXJhY3Rpb24gdHdpY2UgdGhhbiBub3Qgc3RvcCBpdC5cbiAgICBpZiAoIXRoaXMuc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmcoKSAmJlxuICAgICAgICAoIXZlbG9jaXR5IHx8IHZlbG9jaXR5LnggPT09IDAgJiYgdmVsb2NpdHkueSA9PT0gMCkpIHtcbiAgICAgIEZyYW1lUmF0ZUxvZ2dlci5lbmRTY3JvbGwoKTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vblNjcm9sbEVuZERyYWcgJiYgdGhpcy5wcm9wcy5vblNjcm9sbEVuZERyYWcoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uTW9tZW50dW1TY3JvbGxCZWdpbmAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVNb21lbnR1bVNjcm9sbEJlZ2luOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcbiAgICB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxCZWdpbiAmJiB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxCZWdpbihlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Nb21lbnR1bVNjcm9sbEVuZGAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVNb21lbnR1bVNjcm9sbEVuZDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBGcmFtZVJhdGVMb2dnZXIuZW5kU2Nyb2xsKCk7XG4gICAgdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxFbmRUaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcbiAgICB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxFbmQgJiYgdGhpcy5wcm9wcy5vbk1vbWVudHVtU2Nyb2xsRW5kKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblRvdWNoU3RhcnRgIGV2ZW50LlxuICAgKlxuICAgKiBTaW5jZSB3ZSBrbm93IHRoYXQgdGhlIGBTaW1wbGVFdmVudFBsdWdpbmAgb2NjdXJzIGxhdGVyIGluIHRoZSBwbHVnaW5cbiAgICogb3JkZXIsIGFmdGVyIGBSZXNwb25kZXJFdmVudFBsdWdpbmAsIHdlIGNhbiBkZXRlY3QgdGhhdCB3ZSB3ZXJlICpub3QqXG4gICAqIHBlcm1pdHRlZCB0byBiZSB0aGUgcmVzcG9uZGVyIChwcmVzdW1hYmx5IGJlY2F1c2UgYSBjb250YWluZWQgdmlldyBiZWNhbWVcbiAgICogcmVzcG9uZGVyKS4gVGhlIGBvblJlc3BvbmRlclJlamVjdGAgd29uJ3QgZmlyZSBpbiB0aGF0IGNhc2UgLSBpdCBvbmx5XG4gICAqIGZpcmVzIHdoZW4gYSAqY3VycmVudCogcmVzcG9uZGVyIHJlamVjdHMgb3VyIHJlcXVlc3QuXG4gICAqXG4gICAqIEBwYXJhbSB7U3ludGhldGljRXZlbnR9IGUgVG91Y2ggU3RhcnQgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaFN0YXJ0OiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMuc3RhdGUuaXNUb3VjaGluZyA9IHRydWU7XG4gICAgdGhpcy5wcm9wcy5vblRvdWNoU3RhcnQgJiYgdGhpcy5wcm9wcy5vblRvdWNoU3RhcnQoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uVG91Y2hNb3ZlYCBldmVudC5cbiAgICpcbiAgICogU2luY2Ugd2Uga25vdyB0aGF0IHRoZSBgU2ltcGxlRXZlbnRQbHVnaW5gIG9jY3VycyBsYXRlciBpbiB0aGUgcGx1Z2luXG4gICAqIG9yZGVyLCBhZnRlciBgUmVzcG9uZGVyRXZlbnRQbHVnaW5gLCB3ZSBjYW4gZGV0ZWN0IHRoYXQgd2Ugd2VyZSAqbm90KlxuICAgKiBwZXJtaXR0ZWQgdG8gYmUgdGhlIHJlc3BvbmRlciAocHJlc3VtYWJseSBiZWNhdXNlIGEgY29udGFpbmVkIHZpZXcgYmVjYW1lXG4gICAqIHJlc3BvbmRlcikuIFRoZSBgb25SZXNwb25kZXJSZWplY3RgIHdvbid0IGZpcmUgaW4gdGhhdCBjYXNlIC0gaXQgb25seVxuICAgKiBmaXJlcyB3aGVuIGEgKmN1cnJlbnQqIHJlc3BvbmRlciByZWplY3RzIG91ciByZXF1ZXN0LlxuICAgKlxuICAgKiBAcGFyYW0ge1N5bnRoZXRpY0V2ZW50fSBlIFRvdWNoIFN0YXJ0IGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hNb3ZlOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25Ub3VjaE1vdmUgJiYgdGhpcy5wcm9wcy5vblRvdWNoTW92ZShlKTtcbiAgfSxcblxuICAvKipcbiAgICogQSBoZWxwZXIgZnVuY3Rpb24gZm9yIHRoaXMgY2xhc3MgdGhhdCBsZXRzIHVzIHF1aWNrbHkgZGV0ZXJtaW5lIGlmIHRoZVxuICAgKiB2aWV3IGlzIGN1cnJlbnRseSBhbmltYXRpbmcuIFRoaXMgaXMgcGFydGljdWxhcmx5IHVzZWZ1bCB0byBrbm93IHdoZW5cbiAgICogYSB0b3VjaCBoYXMganVzdCBzdGFydGVkIG9yIGVuZGVkLlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmc6IGZ1bmN0aW9uKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlTm93KCk7XG4gICAgY29uc3QgdGltZVNpbmNlTGFzdE1vbWVudHVtU2Nyb2xsRW5kID0gbm93IC0gdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxFbmRUaW1lO1xuICAgIGNvbnN0IGlzQW5pbWF0aW5nID0gdGltZVNpbmNlTGFzdE1vbWVudHVtU2Nyb2xsRW5kIDwgSVNfQU5JTUFUSU5HX1RPVUNIX1NUQVJUX1RIUkVTSE9MRF9NUyB8fFxuICAgICAgdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxFbmRUaW1lIDwgdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxCZWdpblRpbWU7XG4gICAgcmV0dXJuIGlzQW5pbWF0aW5nO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBub2RlIHRoYXQgcmVwcmVzZW50cyBuYXRpdmUgdmlldyB0aGF0IGNhbiBiZSBzY3JvbGxlZC5cbiAgICogQ29tcG9uZW50cyBjYW4gcGFzcyB3aGF0IG5vZGUgdG8gdXNlIGJ5IGRlZmluaW5nIGEgYGdldFNjcm9sbGFibGVOb2RlYFxuICAgKiBmdW5jdGlvbiBvdGhlcndpc2UgYHRoaXNgIGlzIHVzZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZTogZnVuY3Rpb24oKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5nZXRTY3JvbGxhYmxlTm9kZSA/XG4gICAgICB0aGlzLmdldFNjcm9sbGFibGVOb2RlKCkgOlxuICAgICAgUmVhY3ROYXRpdmUuZmluZE5vZGVIYW5kbGUodGhpcyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEEgaGVscGVyIGZ1bmN0aW9uIHRvIHNjcm9sbCB0byBhIHNwZWNpZmljIHBvaW50IGluIHRoZSBTY3JvbGxWaWV3LlxuICAgKiBUaGlzIGlzIGN1cnJlbnRseSB1c2VkIHRvIGhlbHAgZm9jdXMgY2hpbGQgVGV4dFZpZXdzLCBidXQgY2FuIGFsc29cbiAgICogYmUgdXNlZCB0byBxdWlja2x5IHNjcm9sbCB0byBhbnkgZWxlbWVudCB3ZSB3YW50IHRvIGZvY3VzLiBTeW50YXg6XG4gICAqXG4gICAqIGBzY3JvbGxSZXNwb25kZXJTY3JvbGxUbyhvcHRpb25zOiB7eDogbnVtYmVyID0gMDsgeTogbnVtYmVyID0gMDsgYW5pbWF0ZWQ6IGJvb2xlYW4gPSB0cnVlfSlgXG4gICAqXG4gICAqIE5vdGU6IFRoZSB3ZWlyZCBhcmd1bWVudCBzaWduYXR1cmUgaXMgZHVlIHRvIHRoZSBmYWN0IHRoYXQsIGZvciBoaXN0b3JpY2FsIHJlYXNvbnMsXG4gICAqIHRoZSBmdW5jdGlvbiBhbHNvIGFjY2VwdHMgc2VwYXJhdGUgYXJndW1lbnRzIGFzIGFzIGFsdGVybmF0aXZlIHRvIHRoZSBvcHRpb25zIG9iamVjdC5cbiAgICogVGhpcyBpcyBkZXByZWNhdGVkIGR1ZSB0byBhbWJpZ3VpdHkgKHkgYmVmb3JlIHgpLCBhbmQgU0hPVUxEIE5PVCBCRSBVU0VELlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG86IGZ1bmN0aW9uKFxuICAgIHg/OiBudW1iZXIgfCB7IHg/OiBudW1iZXIsIHk/OiBudW1iZXIsIGFuaW1hdGVkPzogYm9vbGVhbiB9LFxuICAgIHk/OiBudW1iZXIsXG4gICAgYW5pbWF0ZWQ/OiBib29sZWFuXG4gICkge1xuICAgIGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnNvbGUud2FybignYHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvKHgsIHksIGFuaW1hdGVkKWAgaXMgZGVwcmVjYXRlZC4gVXNlIGBzY3JvbGxSZXNwb25kZXJTY3JvbGxUbyh7eDogNSwgeTogNSwgYW5pbWF0ZWQ6IHRydWV9KWAgaW5zdGVhZC4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgKHt4LCB5LCBhbmltYXRlZH0gPSB4IHx8IHt9KTtcbiAgICB9XG4gICAgVUlNYW5hZ2VyLmRpc3BhdGNoVmlld01hbmFnZXJDb21tYW5kKFxuICAgICAgbnVsbHRocm93cyh0aGlzLnNjcm9sbFJlc3BvbmRlckdldFNjcm9sbGFibGVOb2RlKCkpLFxuICAgICAgVUlNYW5hZ2VyLlJDVFNjcm9sbFZpZXcuQ29tbWFuZHMuc2Nyb2xsVG8sXG4gICAgICBbeCB8fCAwLCB5IHx8IDAsIGFuaW1hdGVkICE9PSBmYWxzZV0sXG4gICAgKTtcbiAgfSxcblxuICAvKipcbiAgICogU2Nyb2xscyB0byB0aGUgZW5kIG9mIHRoZSBTY3JvbGxWaWV3LCBlaXRoZXIgaW1tZWRpYXRlbHkgb3Igd2l0aCBhIHNtb290aFxuICAgKiBhbmltYXRpb24uXG4gICAqXG4gICAqIEV4YW1wbGU6XG4gICAqXG4gICAqIGBzY3JvbGxSZXNwb25kZXJTY3JvbGxUb0VuZCh7YW5pbWF0ZWQ6IHRydWV9KWBcbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvRW5kOiBmdW5jdGlvbihcbiAgICBvcHRpb25zPzogeyBhbmltYXRlZD86IGJvb2xlYW4gfSxcbiAgKSB7XG4gICAgLy8gRGVmYXVsdCB0byB0cnVlXG4gICAgY29uc3QgYW5pbWF0ZWQgPSAob3B0aW9ucyAmJiBvcHRpb25zLmFuaW1hdGVkKSAhPT0gZmFsc2U7XG4gICAgVUlNYW5hZ2VyLmRpc3BhdGNoVmlld01hbmFnZXJDb21tYW5kKFxuICAgICAgdGhpcy5zY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSgpLFxuICAgICAgVUlNYW5hZ2VyLlJDVFNjcm9sbFZpZXcuQ29tbWFuZHMuc2Nyb2xsVG9FbmQsXG4gICAgICBbYW5pbWF0ZWRdLFxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlcHJlY2F0ZWQsIGRvIG5vdCB1c2UuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJTY3JvbGxXaXRob3V0QW5pbWF0aW9uVG86IGZ1bmN0aW9uKG9mZnNldFg6IG51bWJlciwgb2Zmc2V0WTogbnVtYmVyKSB7XG4gICAgY29uc29sZS53YXJuKCdgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsV2l0aG91dEFuaW1hdGlvblRvYCBpcyBkZXByZWNhdGVkLiBVc2UgYHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvYCBpbnN0ZWFkJyk7XG4gICAgdGhpcy5zY3JvbGxSZXNwb25kZXJTY3JvbGxUbyh7eDogb2Zmc2V0WCwgeTogb2Zmc2V0WSwgYW5pbWF0ZWQ6IGZhbHNlfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEEgaGVscGVyIGZ1bmN0aW9uIHRvIHpvb20gdG8gYSBzcGVjaWZpYyByZWN0IGluIHRoZSBzY3JvbGx2aWV3LiBUaGUgYXJndW1lbnQgaGFzIHRoZSBzaGFwZVxuICAgKiB7eDogbnVtYmVyOyB5OiBudW1iZXI7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyOyBhbmltYXRlZDogYm9vbGVhbiA9IHRydWV9XG4gICAqXG4gICAqIEBwbGF0Zm9ybSBpb3NcbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlclpvb21UbzogZnVuY3Rpb24oXG4gICAgcmVjdDoge3wgeDogbnVtYmVyLCB5OiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBhbmltYXRlZD86IGJvb2xlYW4gfH0sXG4gICAgYW5pbWF0ZWQ/OiBib29sZWFuIC8vIGRlcHJlY2F0ZWQsIHB1dCB0aGlzIGluc2lkZSB0aGUgcmVjdCBhcmd1bWVudCBpbnN0ZWFkXG4gICkge1xuICAgIGludmFyaWFudChTY3JvbGxWaWV3TWFuYWdlciAmJiBTY3JvbGxWaWV3TWFuYWdlci56b29tVG9SZWN0LCAnem9vbVRvUmVjdCBpcyBub3QgaW1wbGVtZW50ZWQnKTtcbiAgICBpZiAoJ2FuaW1hdGVkJyBpbiByZWN0KSB7XG4gICAgICBhbmltYXRlZCA9IHJlY3QuYW5pbWF0ZWQ7XG4gICAgICBkZWxldGUgcmVjdC5hbmltYXRlZDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhbmltYXRlZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnNvbGUud2FybignYHNjcm9sbFJlc3BvbmRlclpvb21Ub2AgYGFuaW1hdGVkYCBhcmd1bWVudCBpcyBkZXByZWNhdGVkLiBVc2UgYG9wdGlvbnMuYW5pbWF0ZWRgIGluc3RlYWQnKTtcbiAgICB9XG4gICAgU2Nyb2xsVmlld01hbmFnZXIuem9vbVRvUmVjdCh0aGlzLnNjcm9sbFJlc3BvbmRlckdldFNjcm9sbGFibGVOb2RlKCksIHJlY3QsIGFuaW1hdGVkICE9PSBmYWxzZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3BsYXlzIHRoZSBzY3JvbGwgaW5kaWNhdG9ycyBtb21lbnRhcmlseS5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckZsYXNoU2Nyb2xsSW5kaWNhdG9yczogZnVuY3Rpb24oKSB7XG4gICAgVUlNYW5hZ2VyLmRpc3BhdGNoVmlld01hbmFnZXJDb21tYW5kKFxuICAgICAgdGhpcy5zY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSgpLFxuICAgICAgVUlNYW5hZ2VyLlJDVFNjcm9sbFZpZXcuQ29tbWFuZHMuZmxhc2hTY3JvbGxJbmRpY2F0b3JzLFxuICAgICAgW11cbiAgICApO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCBhcyB0aGUgY2FsbGJhY2sgdG8gb25Gb2N1cyBpbiBhIFRleHRJbnB1dHMnXG4gICAqIHBhcmVudCB2aWV3LiBOb3RlIHRoYXQgYW55IG1vZHVsZSB1c2luZyB0aGlzIG1peGluIG5lZWRzIHRvIHJldHVyblxuICAgKiB0aGUgcGFyZW50IHZpZXcncyByZWYgaW4gZ2V0U2Nyb2xsVmlld1JlZigpIGluIG9yZGVyIHRvIHVzZSB0aGlzIG1ldGhvZC5cbiAgICogQHBhcmFtIHthbnl9IG5vZGVIYW5kbGUgVGhlIFRleHRJbnB1dCBub2RlIGhhbmRsZVxuICAgKiBAcGFyYW0ge251bWJlcn0gYWRkaXRpb25hbE9mZnNldCBUaGUgc2Nyb2xsIHZpZXcncyBib3R0b20gXCJjb250ZW50SW5zZXRcIi5cbiAgICogICAgICAgIERlZmF1bHQgaXMgMC5cbiAgICogQHBhcmFtIHtib29sfSBwcmV2ZW50TmVnYXRpdmVTY3JvbGxpbmcgV2hldGhlciB0byBhbGxvdyBwdWxsaW5nIHRoZSBjb250ZW50XG4gICAqICAgICAgICBkb3duIHRvIG1ha2UgaXQgbWVldCB0aGUga2V5Ym9hcmQncyB0b3AuIERlZmF1bHQgaXMgZmFsc2UuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJTY3JvbGxOYXRpdmVIYW5kbGVUb0tleWJvYXJkOiBmdW5jdGlvbihub2RlSGFuZGxlOiBhbnksIGFkZGl0aW9uYWxPZmZzZXQ/OiBudW1iZXIsIHByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldD86IGJvb2wpIHtcbiAgICB0aGlzLmFkZGl0aW9uYWxTY3JvbGxPZmZzZXQgPSBhZGRpdGlvbmFsT2Zmc2V0IHx8IDA7XG4gICAgdGhpcy5wcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQgPSAhIXByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldDtcbiAgICBVSU1hbmFnZXIubWVhc3VyZUxheW91dChcbiAgICAgIG5vZGVIYW5kbGUsXG4gICAgICBSZWFjdE5hdGl2ZS5maW5kTm9kZUhhbmRsZSh0aGlzLmdldElubmVyVmlld05vZGUoKSksXG4gICAgICB0aGlzLnNjcm9sbFJlc3BvbmRlclRleHRJbnB1dEZvY3VzRXJyb3IsXG4gICAgICB0aGlzLnNjcm9sbFJlc3BvbmRlcklucHV0TWVhc3VyZUFuZFNjcm9sbFRvS2V5Ym9hcmRcbiAgICApO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUgY2FsY3VsYXRpb25zIHBlcmZvcm1lZCBoZXJlIGFzc3VtZSB0aGUgc2Nyb2xsIHZpZXcgdGFrZXMgdXAgdGhlIGVudGlyZVxuICAgKiBzY3JlZW4gLSBldmVuIGlmIGhhcyBzb21lIGNvbnRlbnQgaW5zZXQuIFdlIHRoZW4gbWVhc3VyZSB0aGUgb2Zmc2V0cyBvZiB0aGVcbiAgICoga2V5Ym9hcmQsIGFuZCBjb21wZW5zYXRlIGJvdGggZm9yIHRoZSBzY3JvbGwgdmlldydzIFwiY29udGVudEluc2V0XCIuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsZWZ0IFBvc2l0aW9uIG9mIGlucHV0IHcuci50LiB0YWJsZSB2aWV3LlxuICAgKiBAcGFyYW0ge251bWJlcn0gdG9wIFBvc2l0aW9uIG9mIGlucHV0IHcuci50LiB0YWJsZSB2aWV3LlxuICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGggV2lkdGggb2YgdGhlIHRleHQgaW5wdXQuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgSGVpZ2h0IG9mIHRoZSB0ZXh0IGlucHV0LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySW5wdXRNZWFzdXJlQW5kU2Nyb2xsVG9LZXlib2FyZDogZnVuY3Rpb24obGVmdDogbnVtYmVyLCB0b3A6IG51bWJlciwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICBsZXQga2V5Ym9hcmRTY3JlZW5ZID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpLmhlaWdodDtcbiAgICBpZiAodGhpcy5rZXlib2FyZFdpbGxPcGVuVG8pIHtcbiAgICAgIGtleWJvYXJkU2NyZWVuWSA9IHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvLmVuZENvb3JkaW5hdGVzLnNjcmVlblk7XG4gICAgfVxuICAgIGxldCBzY3JvbGxPZmZzZXRZID0gdG9wIC0ga2V5Ym9hcmRTY3JlZW5ZICsgaGVpZ2h0ICsgdGhpcy5hZGRpdGlvbmFsU2Nyb2xsT2Zmc2V0O1xuXG4gICAgLy8gQnkgZGVmYXVsdCwgdGhpcyBjYW4gc2Nyb2xsIHdpdGggbmVnYXRpdmUgb2Zmc2V0LCBwdWxsaW5nIHRoZSBjb250ZW50XG4gICAgLy8gZG93biBzbyB0aGF0IHRoZSB0YXJnZXQgY29tcG9uZW50J3MgYm90dG9tIG1lZXRzIHRoZSBrZXlib2FyZCdzIHRvcC5cbiAgICAvLyBJZiByZXF1ZXN0ZWQgb3RoZXJ3aXNlLCBjYXAgdGhlIG9mZnNldCBhdCAwIG1pbmltdW0gdG8gYXZvaWQgY29udGVudFxuICAgIC8vIHNoaWZ0aW5nIGRvd24uXG4gICAgaWYgKHRoaXMucHJldmVudE5lZ2F0aXZlU2Nyb2xsT2Zmc2V0KSB7XG4gICAgICBzY3JvbGxPZmZzZXRZID0gTWF0aC5tYXgoMCwgc2Nyb2xsT2Zmc2V0WSk7XG4gICAgfVxuICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oe3g6IDAsIHk6IHNjcm9sbE9mZnNldFksIGFuaW1hdGVkOiB0cnVlfSk7XG5cbiAgICB0aGlzLmFkZGl0aW9uYWxPZmZzZXQgPSAwO1xuICAgIHRoaXMucHJldmVudE5lZ2F0aXZlU2Nyb2xsT2Zmc2V0ID0gZmFsc2U7XG4gIH0sXG5cbiAgc2Nyb2xsUmVzcG9uZGVyVGV4dElucHV0Rm9jdXNFcnJvcjogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtZWFzdXJpbmcgdGV4dCBmaWVsZDogJywgZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIGBjb21wb25lbnRXaWxsTW91bnRgIGlzIHRoZSBjbG9zZXN0IHRoaW5nIHRvIGEgIHN0YW5kYXJkIFwiY29uc3RydWN0b3JcIiBmb3JcbiAgICogUmVhY3QgY29tcG9uZW50cy5cbiAgICpcbiAgICogVGhlIGBrZXlib2FyZFdpbGxTaG93YCBpcyBjYWxsZWQgYmVmb3JlIGlucHV0IGZvY3VzLlxuICAgKi9cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgY29uc3Qge2tleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHN9ID0gdGhpcy5wcm9wcztcbiAgICB3YXJuaW5nKFxuICAgICAgdHlwZW9mIGtleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHMgIT09ICdib29sZWFuJyxcbiAgICAgIGAna2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcz17JHtrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzfX0nIGlzIGRlcHJlY2F0ZWQuIGBcbiAgICAgICsgYFVzZSAna2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcz1cIiR7a2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyA/ICdhbHdheXMnIDogJ25ldmVyJ31cIicgaW5zdGVhZGBcbiAgICApO1xuXG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMuYWRkaXRpb25hbFNjcm9sbE9mZnNldCA9IDA7XG4gICAgdGhpcy5hZGRMaXN0ZW5lck9uKEtleWJvYXJkLCAna2V5Ym9hcmRXaWxsU2hvdycsIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsU2hvdyk7XG4gICAgdGhpcy5hZGRMaXN0ZW5lck9uKEtleWJvYXJkLCAna2V5Ym9hcmRXaWxsSGlkZScsIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZSk7XG4gICAgdGhpcy5hZGRMaXN0ZW5lck9uKEtleWJvYXJkLCAna2V5Ym9hcmREaWRTaG93JywgdGhpcy5zY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZFNob3cpO1xuICAgIHRoaXMuYWRkTGlzdGVuZXJPbihLZXlib2FyZCwgJ2tleWJvYXJkRGlkSGlkZScsIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaWRIaWRlKTtcbiAgfSxcblxuICAvKipcbiAgICogV2FybmluZywgdGhpcyBtYXkgYmUgY2FsbGVkIHNldmVyYWwgdGltZXMgZm9yIGEgc2luZ2xlIGtleWJvYXJkIG9wZW5pbmcuXG4gICAqIEl0J3MgYmVzdCB0byBzdG9yZSB0aGUgaW5mb3JtYXRpb24gaW4gdGhpcyBtZXRob2QgYW5kIHRoZW4gdGFrZSBhbnkgYWN0aW9uXG4gICAqIGF0IGEgbGF0ZXIgcG9pbnQgKGVpdGhlciBpbiBga2V5Ym9hcmREaWRTaG93YCBvciBvdGhlcikuXG4gICAqXG4gICAqIEhlcmUncyB0aGUgb3JkZXIgdGhhdCBldmVudHMgb2NjdXIgaW46XG4gICAqIC0gZm9jdXNcbiAgICogLSB3aWxsU2hvdyB7c3RhcnRDb29yZGluYXRlcywgZW5kQ29vcmRpbmF0ZXN9IHNldmVyYWwgdGltZXNcbiAgICogLSBkaWRTaG93IHNldmVyYWwgdGltZXNcbiAgICogLSBibHVyXG4gICAqIC0gd2lsbEhpZGUge3N0YXJ0Q29vcmRpbmF0ZXMsIGVuZENvb3JkaW5hdGVzfSBzZXZlcmFsIHRpbWVzXG4gICAqIC0gZGlkSGlkZSBzZXZlcmFsIHRpbWVzXG4gICAqXG4gICAqIFRoZSBgU2Nyb2xsUmVzcG9uZGVyYCBwcm92aWRlc01vZHVsZSBjYWxsYmFja3MgZm9yIGVhY2ggb2YgdGhlc2UgZXZlbnRzLlxuICAgKiBFdmVuIHRob3VnaCBhbnkgdXNlciBjb3VsZCBoYXZlIGVhc2lseSBsaXN0ZW5lZCB0byBrZXlib2FyZCBldmVudHNcbiAgICogdGhlbXNlbHZlcywgdXNpbmcgdGhlc2UgYHByb3BzYCBjYWxsYmFja3MgZW5zdXJlcyB0aGF0IG9yZGVyaW5nIG9mIGV2ZW50c1xuICAgKiBpcyBjb25zaXN0ZW50IC0gYW5kIG5vdCBkZXBlbmRlbnQgb24gdGhlIG9yZGVyIHRoYXQgdGhlIGtleWJvYXJkIGV2ZW50cyBhcmVcbiAgICogc3Vic2NyaWJlZCB0by4gVGhpcyBtYXR0ZXJzIHdoZW4gdGVsbGluZyB0aGUgc2Nyb2xsIHZpZXcgdG8gc2Nyb2xsIHRvIHdoZXJlXG4gICAqIHRoZSBrZXlib2FyZCBpcyBoZWFkZWQgLSB0aGUgc2Nyb2xsIHJlc3BvbmRlciBiZXR0ZXIgaGF2ZSBiZWVuIG5vdGlmaWVkIG9mXG4gICAqIHRoZSBrZXlib2FyZCBkZXN0aW5hdGlvbiBiZWZvcmUgYmVpbmcgaW5zdHJ1Y3RlZCB0byBzY3JvbGwgdG8gd2hlcmUgdGhlXG4gICAqIGtleWJvYXJkIHdpbGwgYmUuIFN0aWNrIHRvIHRoZSBgU2Nyb2xsUmVzcG9uZGVyYCBjYWxsYmFja3MsIGFuZCBldmVyeXRoaW5nXG4gICAqIHdpbGwgd29yay5cbiAgICpcbiAgICogV0FSTklORzogVGhlc2UgY2FsbGJhY2tzIHdpbGwgZmlyZSBldmVuIGlmIGEga2V5Ym9hcmQgaXMgZGlzcGxheWVkIGluIGFcbiAgICogZGlmZmVyZW50IG5hdmlnYXRpb24gcGFuZS4gRmlsdGVyIG91dCB0aGUgZXZlbnRzIHRvIGRldGVybWluZSBpZiB0aGV5IGFyZVxuICAgKiByZWxldmFudCB0byB5b3UuIChGb3IgZXhhbXBsZSwgb25seSBpZiB5b3UgcmVjZWl2ZSB0aGVzZSBjYWxsYmFja3MgYWZ0ZXJcbiAgICogeW91IGhhZCBleHBsaWNpdGx5IGZvY3VzZWQgYSBub2RlIGV0YykuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxTaG93OiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvID0gZTtcbiAgICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvdyAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvdyhlKTtcbiAgfSxcblxuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxIaWRlOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvID0gbnVsbDtcbiAgICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsSGlkZSAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsSGlkZShlKTtcbiAgfSxcblxuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZFNob3c6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgLy8gVE9ETyg3NjkzOTYxKTogVGhlIGV2ZW50IGZvciBEaWRTaG93IGlzIG5vdCBhdmFpbGFibGUgb24gaU9TIHlldC5cbiAgICAvLyBVc2UgdGhlIG9uZSBmcm9tIFdpbGxTaG93IGFuZCBkbyBub3QgYXNzaWduLlxuICAgIGlmIChlKSB7XG4gICAgICB0aGlzLmtleWJvYXJkV2lsbE9wZW5UbyA9IGU7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25LZXlib2FyZERpZFNob3cgJiYgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkU2hvdyhlKTtcbiAgfSxcblxuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZEhpZGU6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMucHJvcHMub25LZXlib2FyZERpZEhpZGUgJiYgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkSGlkZShlKTtcbiAgfVxuXG59O1xuXG5jb25zdCBTY3JvbGxSZXNwb25kZXIgPSB7XG4gIE1peGluOiBTY3JvbGxSZXNwb25kZXJNaXhpbixcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU2Nyb2xsUmVzcG9uZGVyO1xuIl19