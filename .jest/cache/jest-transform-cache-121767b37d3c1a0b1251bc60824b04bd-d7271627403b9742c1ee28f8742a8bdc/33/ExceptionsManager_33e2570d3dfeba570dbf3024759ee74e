cb30de253879d38c5a6dac2319e50ffd

'use strict';

var exceptionID = 0;
function reportException(e, isFatal) {
  var _require = require('NativeModules'),
      ExceptionsManager = _require.ExceptionsManager;

  if (ExceptionsManager) {
    var parseErrorStack = require('parseErrorStack');
    var stack = parseErrorStack(e);
    var currentExceptionID = ++exceptionID;
    if (isFatal) {
      ExceptionsManager.reportFatalException(e.message, stack, currentExceptionID);
    } else {
      ExceptionsManager.reportSoftException(e.message, stack, currentExceptionID);
    }
    if (__DEV__) {
      var symbolicateStackTrace = require('symbolicateStackTrace');
      symbolicateStackTrace(stack).then(function (prettyStack) {
        if (prettyStack) {
          ExceptionsManager.updateExceptionMessage(e.message, prettyStack, currentExceptionID);
        } else {
          throw new Error('The stack is null');
        }
      }).catch(function (error) {
        return console.warn('Unable to symbolicate stack trace: ' + error.message);
      });
    }
  }
}

function handleException(e, isFatal) {
  if (!e.message) {
    e = new Error(e);
  }
  if (console._errorOriginal) {
    console._errorOriginal(e.message);
  } else {
    console.error(e.message);
  }
  reportException(e, isFatal);
}

function reactConsoleErrorHandler() {
  console._errorOriginal.apply(console, arguments);
  if (!console.reportErrorsAsExceptions) {
    return;
  }

  if (arguments[0] && arguments[0].stack) {
    reportException(arguments[0], false);
  } else {
    var stringifySafe = require('stringifySafe');
    var str = Array.prototype.map.call(arguments, stringifySafe).join(', ');
    if (str.slice(0, 10) === '"Warning: ') {
      return;
    }
    var error = new Error('console.error: ' + str);
    error.framesToPop = 1;
    reportException(error, false);
  }
}

function installConsoleErrorReporter() {
  if (console._errorOriginal) {
    return;
  }

  console._errorOriginal = console.error.bind(console);
  console.error = reactConsoleErrorHandler;
  if (console.reportErrorsAsExceptions === undefined) {
    console.reportErrorsAsExceptions = true;
  }
}

module.exports = { handleException: handleException, installConsoleErrorReporter: installConsoleErrorReporter };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkV4Y2VwdGlvbnNNYW5hZ2VyLmpzIl0sIm5hbWVzIjpbImV4Y2VwdGlvbklEIiwicmVwb3J0RXhjZXB0aW9uIiwiZSIsImlzRmF0YWwiLCJyZXF1aXJlIiwiRXhjZXB0aW9uc01hbmFnZXIiLCJwYXJzZUVycm9yU3RhY2siLCJzdGFjayIsImN1cnJlbnRFeGNlcHRpb25JRCIsInJlcG9ydEZhdGFsRXhjZXB0aW9uIiwibWVzc2FnZSIsInJlcG9ydFNvZnRFeGNlcHRpb24iLCJfX0RFVl9fIiwic3ltYm9saWNhdGVTdGFja1RyYWNlIiwidGhlbiIsInByZXR0eVN0YWNrIiwidXBkYXRlRXhjZXB0aW9uTWVzc2FnZSIsIkVycm9yIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiaGFuZGxlRXhjZXB0aW9uIiwiX2Vycm9yT3JpZ2luYWwiLCJyZWFjdENvbnNvbGVFcnJvckhhbmRsZXIiLCJhcHBseSIsImFyZ3VtZW50cyIsInJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyIsInN0cmluZ2lmeVNhZmUiLCJzdHIiLCJBcnJheSIsInByb3RvdHlwZSIsIm1hcCIsImNhbGwiLCJqb2luIiwic2xpY2UiLCJmcmFtZXNUb1BvcCIsImluc3RhbGxDb25zb2xlRXJyb3JSZXBvcnRlciIsImJpbmQiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiO0FBU0E7O0FBT0EsSUFBSUEsY0FBYyxDQUFsQjtBQUNBLFNBQVNDLGVBQVQsQ0FBeUJDLENBQXpCLEVBQTJDQyxPQUEzQyxFQUEwRDtBQUFBLGlCQUM1QkMsUUFBUSxlQUFSLENBRDRCO0FBQUEsTUFDakRDLGlCQURpRCxZQUNqREEsaUJBRGlEOztBQUV4RCxNQUFJQSxpQkFBSixFQUF1QjtBQUNyQixRQUFNQyxrQkFBa0JGLFFBQVEsaUJBQVIsQ0FBeEI7QUFDQSxRQUFNRyxRQUFRRCxnQkFBZ0JKLENBQWhCLENBQWQ7QUFDQSxRQUFNTSxxQkFBcUIsRUFBRVIsV0FBN0I7QUFD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IDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAcHJvdmlkZXNNb2R1bGUgRXhjZXB0aW9uc01hbmFnZXJcbiAqIEBmbG93XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHR5cGUge0V4dGVuZGVkRXJyb3J9IGZyb20gJ3BhcnNlRXJyb3JTdGFjayc7XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV2ZWxvcGVyLXZpc2libGUgYXNwZWN0IG9mIGVycm9ycyBhbmQgZXhjZXB0aW9uc1xuICovXG5sZXQgZXhjZXB0aW9uSUQgPSAwO1xuZnVuY3Rpb24gcmVwb3J0RXhjZXB0aW9uKGU6IEV4dGVuZGVkRXJyb3IsIGlzRmF0YWw6IGJvb2wpIHtcbiAgY29uc3Qge0V4Y2VwdGlvbnNNYW5hZ2VyfSA9IHJlcXVpcmUoJ05hdGl2ZU1vZHVsZXMnKTtcbiAgaWYgKEV4Y2VwdGlvbnNNYW5hZ2VyKSB7XG4gICAgY29uc3QgcGFyc2VFcnJvclN0YWNrID0gcmVxdWlyZSgncGFyc2VFcnJvclN0YWNrJyk7XG4gICAgY29uc3Qgc3RhY2sgPSBwYXJzZUVycm9yU3RhY2soZSk7XG4gICAgY29uc3QgY3VycmVudEV4Y2VwdGlvbklEID0gKytleGNlcHRpb25JRDtcbiAgICBpZiAoaXNGYXRhbCkge1xuICAgICAgRXhjZXB0aW9uc01hbmFnZXIucmVwb3J0RmF0YWxFeGNlcHRpb24oZS5tZXNzYWdlLCBzdGFjaywgY3VycmVudEV4Y2VwdGlvbklEKTtcbiAgICB9IGVsc2Uge1xuICAgICAgRXhjZXB0aW9uc01hbmFnZXIucmVwb3J0U29mdEV4Y2VwdGlvbihlLm1lc3NhZ2UsIHN0YWNrLCBjdXJyZW50RXhjZXB0aW9uSUQpO1xuICAgIH1cbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgY29uc3Qgc3ltYm9saWNhdGVTdGFja1RyYWNlID0gcmVxdWlyZSgnc3ltYm9saWNhdGVTdGFja1RyYWNlJyk7XG4gICAgICBzeW1ib2xpY2F0ZVN0YWNrVHJhY2Uoc3RhY2spLnRoZW4oXG4gICAgICAgIChwcmV0dHlTdGFjaykgPT4ge1xuICAgICAgICAgIGlmIChwcmV0dHlTdGFjaykge1xuICAgICAgICAgICAgRXhjZXB0aW9uc01hbmFnZXIudXBkYXRlRXhjZXB0aW9uTWVzc2FnZShlLm1lc3NhZ2UsIHByZXR0eVN0YWNrLCBjdXJyZW50RXhjZXB0aW9uSUQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzdGFjayBpcyBudWxsJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApLmNhdGNoKFxuICAgICAgICAoZXJyb3IpID0+IGNvbnNvbGUud2FybignVW5hYmxlIHRvIHN5bWJvbGljYXRlIHN0YWNrIHRyYWNlOiAnICsgZXJyb3IubWVzc2FnZSlcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5cbmRlY2xhcmUgdmFyIGNvbnNvbGU6IHR5cGVvZiBjb25zb2xlICYge1xuICBfZXJyb3JPcmlnaW5hbDogRnVuY3Rpb24sXG4gIHJlcG9ydEVycm9yc0FzRXhjZXB0aW9uczogYm9vbGVhbixcbn07XG5cbi8qKlxuICogTG9ncyBleGNlcHRpb25zIHRvIHRoZSAobmF0aXZlKSBjb25zb2xlIGFuZCBkaXNwbGF5cyB0aGVtXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUV4Y2VwdGlvbihlOiBFcnJvciwgaXNGYXRhbDogYm9vbGVhbikge1xuICAvLyBXb3JrYXJvdW5kIGZvciByZXBvcnRpbmcgZXJyb3JzIGNhdXNlZCBieSBgdGhyb3cgJ3NvbWUgc3RyaW5nJ2BcbiAgLy8gVW5mb3J0dW5hdGVseSB0aGVyZSBpcyBubyB3YXkgdG8gZmlndXJlIG91dCB0aGUgc3RhY2t0cmFjZSBpbiB0aGlzXG4gIC8vIGNhc2UsIHNvIGlmIHlvdSBlbmRlZCB1cCBoZXJlIHRyeWluZyB0byB0cmFjZSBhbiBlcnJvciwgbG9vayBmb3JcbiAgLy8gYHRocm93ICc8ZXJyb3IgbWVzc2FnZT4nYCBzb21ld2hlcmUgaW4geW91ciBjb2RlYmFzZS5cbiAgaWYgKCFlLm1lc3NhZ2UpIHtcbiAgICBlID0gbmV3IEVycm9yKGUpO1xuICB9XG4gIGlmIChjb25zb2xlLl9lcnJvck9yaWdpbmFsKSB7XG4gICAgY29uc29sZS5fZXJyb3JPcmlnaW5hbChlLm1lc3NhZ2UpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoZS5tZXNzYWdlKTtcbiAgfVxuICByZXBvcnRFeGNlcHRpb24oZSwgaXNGYXRhbCk7XG59XG5cbmZ1bmN0aW9uIHJlYWN0Q29uc29sZUVycm9ySGFuZGxlcigpIHtcbiAgY29uc29sZS5fZXJyb3JPcmlnaW5hbC5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xuICBpZiAoIWNvbnNvbGUucmVwb3J0RXJyb3JzQXNFeGNlcHRpb25zKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGFyZ3VtZW50c1swXSAmJiBhcmd1bWVudHNbMF0uc3RhY2spIHtcbiAgICByZXBvcnRFeGNlcHRpb24oYXJndW1lbnRzWzBdLCAvKiBpc0ZhdGFsICovIGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBzdHJpbmdpZnlTYWZlID0gcmVxdWlyZSgnc3RyaW5naWZ5U2FmZScpO1xuICAgIGNvbnN0IHN0ciA9IEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChhcmd1bWVudHMsIHN0cmluZ2lmeVNhZmUpLmpvaW4oJywgJyk7XG4gICAgaWYgKHN0ci5zbGljZSgwLCAxMCkgPT09ICdcIldhcm5pbmc6ICcpIHtcbiAgICAgIC8vIFJlYWN0IHdhcm5pbmdzIHVzZSBjb25zb2xlLmVycm9yIHNvIHRoYXQgYSBzdGFjayB0cmFjZSBpcyBzaG93biwgYnV0XG4gICAgICAvLyB3ZSBkb24ndCAoY3VycmVudGx5KSB3YW50IHRoZXNlIHRvIHNob3cgYSByZWRib3hcbiAgICAgIC8vIChOb3RlOiBMb2dpYyBkdXBsaWNhdGVkIGluIHBvbHlmaWxscy9jb25zb2xlLmpzLilcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXJyb3IgOiBFeHRlbmRlZEVycm9yID0gbmV3IEVycm9yKCdjb25zb2xlLmVycm9yOiAnICsgc3RyKTtcbiAgICBlcnJvci5mcmFtZXNUb1BvcCA9IDE7XG4gICAgcmVwb3J0RXhjZXB0aW9uKGVycm9yLCAvKiBpc0ZhdGFsICovIGZhbHNlKTtcbiAgfVxufVxuXG4vKipcbiAqIFNob3dzIGEgcmVkYm94IHdpdGggc3RhY2t0cmFjZSBmb3IgYWxsIGNvbnNvbGUuZXJyb3IgbWVzc2FnZXMuICBEaXNhYmxlIGJ5XG4gKiBzZXR0aW5nIGBjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyA9IGZhbHNlO2AgaW4geW91ciBhcHAuXG4gKi9cbmZ1bmN0aW9uIGluc3RhbGxDb25zb2xlRXJyb3JSZXBvcnRlcigpIHtcbiAgLy8gRW5hYmxlIHJlcG9ydEVycm9yc0FzRXhjZXB0aW9uc1xuICBpZiAoY29uc29sZS5fZXJyb3JPcmlnaW5hbCkge1xuICAgIHJldHVybjsgLy8gYWxyZWFkeSBpbnN0YWxsZWRcbiAgfVxuICAvLyBGbG93IGRvZXNuJ3QgbGlrZSBpdCB3aGVuIHlvdSBzZXQgYXJiaXRyYXJ5IHZhbHVlcyBvbiBhIGdsb2JhbCBvYmplY3RcbiAgY29uc29sZS5fZXJyb3JPcmlnaW5hbCA9IGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKTtcbiAgY29uc29sZS5lcnJvciA9IHJlYWN0Q29uc29sZUVycm9ySGFuZGxlcjtcbiAgaWYgKGNvbnNvbGUucmVwb3J0RXJyb3JzQXNFeGNlcHRpb25zID09PSB1bmRlZmluZWQpIHtcbiAgICAvLyBJbmRpdmlkdWFsIGFwcHMgY2FuIGRpc2FibGUgdGhpc1xuICAgIC8vIEZsb3cgZG9lc24ndCBsaWtlIGl0IHdoZW4geW91IHNldCBhcmJpdHJhcnkgdmFsdWVzIG9uIGEgZ2xvYmFsIG9iamVjdFxuICAgIGNvbnNvbGUucmVwb3J0RXJyb3JzQXNFeGNlcHRpb25zID0gdHJ1ZTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgaGFuZGxlRXhjZXB0aW9uLCBpbnN0YWxsQ29uc29sZUVycm9yUmVwb3J0ZXIgfTtcbiJdfQ==